.\" Copyright 2014 Garrett D'Amore <garrett@damore.org>
.\" Copyright (c) 2004, Sun Microsystems, Inc. All Rights Reserved.
.\" The contents of this file are subject to the terms of the Common Development and Distribution License (the "License").  You may not use this file except in compliance with the License.
.\" You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE or http://www.opensolaris.org/os/licensing.  See the License for the specific language governing permissions and limitations under the License.
.\" When distributing Covered Code, include this CDDL HEADER in each file and include the License file at usr/src/OPENSOLARIS.LICENSE.  If applicable, add the following below this CDDL HEADER, with the fields enclosed by brackets "[]" replaced with your own identifying information: Portions Copyright [yyyy] [name of copyright owner]
.Dd "Aug 22, 2014"
.Dt SCANDIR 3C
.Os
.Sh NAME
.Nm scandir ,
.Nm alphasort
.Nd scan a directory
.Sh SYNOPSIS
.In dirent.h
.
.Ft int
.Fo scandir
.Fa "const char *dirname"
.Fa "struct dirent ***namelist"
.Fa "int \*(lp*select\*(rp\*(lpconst struct dirent *\*(rp"
.Fa "int \*(lp*dcomp\*(rp\*(lpconst struct dirent  **, const struct dirent **\*(rp"
.Fc
.
.Ft int
.Fn alphasort "const struct dirent **d1" "const struct dirent **d2"
.
.Sh DESCRIPTION
The
.Fn scandir
function reads the directory
.Fa dirname
using
.Xr readdir 3C
and builds an array of pointers to directory entries using
.Xr malloc 3C .
The
.Fa namelist
argument is a pointer to an array of
structure pointers. The
.Fa select
argument is a pointer to a routine that is
called with a pointer to a directory entry and returns a non-zero value if the
directory entry is included in the array. If this pointer is
.Dv NULL ,
then
all the directory entries are included. The
.Fa dcomp
argument is a pointer
to a routine that is passed to
.Xr qsort 3C ,
which sorts the completed array. If this pointer is
.Dv NULL ,
the array is not sorted.
.Lp
The
.Fn alphasort
function can be used as the
.Fn dcomp
function parameter for the
.Fn scandir
function to sort the directory entries into
alphabetical order, as if by the
.Xr strcoll 3C
function. Its arguments are
the two directory entries to compare.
.Sh RETURN VALUES
The
.Fn scandir
function returns the number of entries in the array and a
pointer to the array through the
.Fa namelist
argument. When an error is
encountered,
.Fn scandir
returns -1 and
.Va errno
is set to indicate the error.
.Lp
The
.Fn alphasort
function returns an integer greater than, equal to, or
less than 0 if the directory entry name pointed to by
.Fa d1
is greater than, equal to, or less than the directory entry name pointed to by
.Fa d2
when
both are interpreted as appropriate to the current locale. There is no return
value reserved to indicate an error.
.Sh ERRORS
The
.Fn scandir
function will fail if:
.Bl -tag -width Er
.It Er EOVERFLOW
The number of directory entries exceeds the number that can be represented by
an
.Vt int .
.El
.Sh USAGE
The
.Fn scandir
and
.Fn alphasort
functions have transitional interfaces for 64-bit file offsets. See
.Xr lf64 5 .
.Sh INTERFACE STABILITY
.Sy Standard .
.Sh MT-LEVEL
The
.Fn scandir
function is
.Sy Unsafe .
The
.Fn alphasort
function is
.Sy Safe .
.Sh SEE ALSO
.Xr malloc 3C ,
.Xr qsort 3C ,
.Xr readdir 3C ,
.Xr strcoll 3C ,
.Xr lf64 5 ,
.Xr standards 5
.Sh STANDARDS
The
.Fn alphasort
and
.Fn scandir
functions are available in the following compilation environment. See
.Xr standards 5 .
.Lp
.Bl -bullet -compact
.It
.St -p1003.1-2008
.El
